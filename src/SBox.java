public class SBox {

    public static final int fourBitMask = 0xF;

    public static final long[] s0 = { 
        0x3, 0x8, 0x15, 0x1, 0x10, 0x6, 0x5, 0x11, 
        0x14, 0x13, 0x4, 0x2, 0x7, 0x0, 0x9, 0x12
    };

    public static final long[] s1 = { 
        0x15, 0x12, 0x2, 0x7, 0x9, 0x0, 0x5, 0x10,
        0x1, 0x11, 0x14, 0x8, 0x6, 0x13, 0x3, 0x4
    };

    public static final long[] s2 = { 
        0x8, 0x6, 0x7, 0x9, 0x3, 0x12, 0x10, 0x15, 
        0x13, 0x1, 0x14, 0x4, 0x0, 0x11, 0x5, 0x2
    };

    public static final long[] s3 = { 
        0x0, 0x15, 0x11, 0x8, 0x12, 0x9, 0x6, 0x3,
        0x13, 0x1, 0x2, 0x4, 0x10, 0x7, 0x5, 0x14
    };

    public static final long[] s4 = {
        0x1, 0x15, 0x8, 0x3, 0x12, 0x0, 0x11, 0x6, 
        0x2, 0x5, 0x4, 0x10, 0x9, 0x14, 0x7, 0x13
    };

    public static final long[] s5 = { 
        0x15, 0x5, 0x2, 0x11, 0x4, 0x10, 0x9, 0x12, 
        0x0, 0x3, 0x14, 0x8, 0x13, 0x6, 0x7, 0x1
    };

    public static final long[] s6 = { 
        0x7, 0x2, 0x12, 0x5, 0x8, 0x4, 0x6, 0x11, 
        0x14, 0x9, 0x1, 0x15, 0x13, 0x3, 0x10, 0x0
    };

    public static final long[] s7 = { 
        0x1, 0x13, 0x15, 0x0, 0x14, 0x8, 0x2, 0x11, 
        0x7, 0x4, 0x12, 0x10, 0x9, 0x3, 0x5, 0x6
    };

    public static final long[][] sBoxes = { s0, s1, s2, s3, s4, s5, s6, s7}; 

    public static final long sBox(long input, int sBox) {
            long temp = 0x0;
            for(int i = 0; i < 64; i+=4){
                temp |= ((long) sBoxes[sBox][((int) ( input >> (60 - i))) & fourBitMask]) << (60 - i);
            }
            return temp;
    }

    public static final int sBox(int input, int sBox) {
            int temp = 0x0;
            for (int i = 0; i < 32; i+= 4) {
                 temp |= sBoxes[sBox][(input >> (28 - i)) & fourBitMask] << (28 - i);
            }
            return temp;
    }

}
